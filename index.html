<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mini Advent of Code</title>
  <link rel="icon" type="image/x-icon"
    href="https://raw.githubusercontent.com/leox7-bths/mini-advent-of-code/refs/heads/main/icon.png">
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header>
    <button onclick="displayPage('home')" class="text-button" style="color:#00cc00;">[ Home ]</button>
    <!-- Passing 2050 into displayPage() acts as a default page when clicking [ Days ]:
     it directs the client to Leo's Advent of Code.
     
     When a browsing tab for Advents is created, this should be changed. -->
    <button onclick="displayPage(2050)" class="text-button" style="color:#00cc00;">[ Days ]</button>
    <button onclick="displayPage('search')" class="text-button" style="color:#00cc00;">[ Search ]</button>
    <button onclick="displayPage('about')" class="text-button" style="color:#00cc00;">[ About Us ]</button>
    <h1>Mini Advent of Code</h1>
  </header>

  <main>

    <!-- IDs for calling days using displayPage() -->
    <div class="controls" id="dayControls">
      <label for="daySelect">Select Day: </label>
      <select id="daySelect">
        <option value="2050">Day 2050</option>
        <option value="-1">Day -1</option>
        <option value="25">Day 25</option>
        <option value="Test">Test Day</option>
        <option value="Test2">Test Day 2</option>
      </select>
    </div>

    <div id="days">
      <iframe id="dayFrame" scrolling="no" style="
      width: 100%;
      max-width: 900px;
      min-height: 2000px;
      border: none;
      display: block;
      margin: 0 auto;
      overflow: hidden;
    " loading="lazy">
      </iframe>

      <!-- Home -->
      <div class="day-container" id="home">
        <h1>[ --- Mini Advent of Code --- ]</h1>
        <p>
          Welcome to the official <a style="color: #00cc00;">Mini Advent of Code </a>website!
          You can browse through various custom, fan-made Christmas-themed programming problems made by your peers here,
          or you could submit your own through
          <a href="https://forms.gle/cGSTsMqioSZGzgRf9" target="_blank" style="color: #00cc00;">
            here</a>.
        </p>
        <p>We encourage you to demonstrate your creativity and to submit your own problems to our site: the more the
          merrier!</p>
        <p>Happy solving!</p>
      </div>

      <!-- Search -->
        <div class="day-container" id="search">
            <h2>Search Days</h2>
            <div class="search-bar">
                <input
                        type="search"
                        id="searchInput"
                        placeholder="Search by day, title, or author"
                />
                <button id="filterBtn" class="text-button">Filter ▾</button>
            </div>

            <div id="filterMenu" class="filter-menu" style="display:none;">
                <div data-filter="all">All</div>
                <div data-filter="author">Author</div>
                <div data-filter="title">Title</div>
                <div data-filter="day">Day</div>
            </div>

            <ul id="searchResults"></ul>
        </div>

        <script>
            const daysIndex = [
              { day: 2050, title: "Time Travel!?", author: "Leo Xu" },
              { day: -1, title: "Grinch!", author: "Alston Liu" },
              { day: 25, title: "Delivery Dilemma", author: "Selina Jiang" },
              { day: "Test", title: "Test", author: "Test" },
              { day: "Test2", title: "Test2", author: "Test2" },
              { day: "Test3", title: "Test3", author: "Test3" }
            ];
            let activeFilter = 'all';
            const input = document.getElementById('searchInput');
            const results = document.getElementById('searchResults');
            const filterBtn = document.getElementById('filterBtn');
            const filterMenu = document.getElementById('filterMenu');
            // ----- Filter menu toggle -----
            filterBtn.onclick = () => {
              filterMenu.style.display =
                filterMenu.style.display === 'block' ? 'none' : 'block';
            };
            // ----- Select filter -----
            filterMenu.querySelectorAll('div').forEach(option => {
              option.onclick = () => {
                activeFilter = option.dataset.filter;
                filterBtn.textContent = `Filter: ${option.textContent} ▾`;
                filterMenu.style.display = 'none';
                runSearch();
              };
            });

            // ----- Search -----
            input.addEventListener('input', runSearch);

            function runSearch() {
              console.log("runSearch called with query:", input.Value);
              console.log("activeFilter:", activeFilter);

              const query = input.value.toLowerCase().trim();
              results.innerHTML = '';

              if (!query) return;

              const matches = daysIndex.filter(d => {
                if (activeFilter === 'author')
                  return d.author.toLowerCase().includes(query);

                if (activeFilter === 'title')
                  return d.title.toLowerCase().includes(query);

                if (activeFilter === 'day')
                  return d.day.toString().includes(query);

                return (
                  d.day.toString().includes(query) ||
                  d.title.toLowerCase().includes(query) ||
                  d.author.toLowerCase().includes(query)
                );
              });

              if (!matches.length) {
                results.innerHTML = '<li>No results found</li>';
                return;
              }

              matches.forEach(d => {
                const li = document.createElement('li');
                li.innerHTML = `
                  <button class="text-button" style="color:#00cc00">
                    Day ${d.day} — ${d.title} (by ${d.author})
                  </button>
                `;
                li.querySelector('button').onclick = () => displayPage(d.day);
                results.appendChild(li);
              });
            }

            // ----- Close filter when clicking outside -----
            document.addEventListener('click', e => {
              if (!filterBtn.contains(e.target) && !filterMenu.contains(e.target)) {
                filterMenu.style.display = 'none';
              }
            });
        console.log("Search script loaded");
        console.log("daysIndex:", daysIndex);
        console.log("Search input element:", document.getElementById('searchInput'));
        </script>

        <!-- About -->
      <div class="day-container" id="about">
        <h2>This Advent of Code is also free to use.</h2>
        <h3>However, we wish you can have basic respect to our site builders </h3>
        <h3>and the fabulous creativity of our prompt contributors. </h3>
        <h1>[ --- About Us --- ]</h1>
        <h2 style="margin: 0;">Development Team</h2>
        <h3>Lead Developer (scripting, web-design)</h3>
        <p>
          <a href="https://github.com/leox7-bths" target="_blank" style="color: #00cc00;">
            Leo Xu</a>

        </p>
          <p>
              <a href="https://github.com/WoodFish0226" target="_blank" style="color: #00cc00;">
                  Yuhao Chen</a>

              <button onclick="toggleText(1, this)" class="text-button" style="color:#00cc00;">
                  Expand</button>
          </p>

        <p id="text1" style="display:none;">
          Bob the builder was here.
        </p>


        <h3>Writer (web-design, content manager)</h3>
        <p>
          <a href="https://github.com/ill-birdie" target="_blank" style="color: #00cc00;">
            Ava</a>

          <button onclick="toggleText(2, this)" class="text-button" style="color:#00cc00;">
            Expand</button>
        </p>
        <p id="text2" style="display:none;">
          Hi, I'm the writer and screener of Mini Advent of Code! I'm really excited for the creation of this project,
          because being able to host, read through, and solve various individual's creations is an honor.
          If you'd like to personally send me a project, please do through GitHub. I'd love to see what you've made!
        </p>


        <hr style="border: 1px solid #ffffff; margin: 0px 0;">
        <p style="text-align:center;">⋅ ⋆⋅ ☽ ◯ ☾ ⋅⋆ ⋅</p>
        <hr style="border: 1px solid #ffffff; margin: 0px 0;">
        <h3 style="margin: 0;">Contributors</h3>
        <p style="margin: 0;">Leo Xu - <button onclick="displayPage(1)" class="text-button" style="color:#00cc00;">Day
            2050</button></p>
        <p style="margin: 0;">Alston Liu - <button onclick="displayPage(2)" class="text-button"
            style="color:#00cc00;">Day -1</button></p>
        <p style="margin: 0;">Selina Jiang - <button onclick="displayPage(3)" class="text-button"
            style="color:#00cc00;">Day 25</button></p>
      </div>


      <script>
        function toggleText(id, btn) {
          const text = document.getElementById('text' + id);
          if (text.style.display === 'none') {
            text.style.display = 'block';
            btn.textContent = 'Collapse';
          } else {
            text.style.display = 'none';
            btn.textContent = 'Expand';
          }
        }
      </script>

    </div>
  </main>

  <script>
    const daySelect = document.getElementById('daySelect');
    const dayControls = document.getElementById('dayControls');
    const frame = document.getElementById('dayFrame');

    function hideAllInlineDays() {
      document.querySelectorAll('.day-container').forEach(d => {
        d.classList.remove('active');
      });
    }

    function displayPage(page) {
      hideAllInlineDays();

      // Displays Home, Search, and About Us pages when prompted
      if (page == 'home' || page === 'search' || page == 'about') {
        dayControls.style.display = "none";
        frame.style.display = "none";
        document.getElementById(`${page}`).classList.add('active');
        return;
      }

      // NORMAL DAYS
      dayControls.style.display = "block";
      frame.style.display = "block";
      frame.src = `days/day${page}.html`;
    }

    daySelect.addEventListener('change', e => displayPage(e.target.value));
    displayPage('home');
  </script>

  <script>
    function toggleText(id, btn) {
      const text = document.getElementById('text' + id);
      if (text.style.display === 'none') {
        text.style.display = 'block';
        btn.textContent = 'Collapse';
      } else {
        text.style.display = 'none';
        btn.textContent = 'Expand';
      }
    }
  </script>
</body>


</html>